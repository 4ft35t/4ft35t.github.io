<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>解决无忧行长时间显示“正在连接电话服务器”问题 | 4ft35t blog</title><meta property="og:title" content="解决无忧行长时间显示“正在连接电话服务器”问题 - 4ft35t blog"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-04-09T21:48:15+08:00"><meta property="article:modified_time" content="2020-04-09T21:48:15+08:00"><meta name=Keywords content="openwrt,lede,router"><meta name=description content="解决无忧行长时间显示“正在连接电话服务器”问题"><meta name=author content="af.test"><meta property="og:url" content="https://4ft35t.github.io/post/jegotrip-takes-long-time-to-connect/"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/style.css><script type=text/javascript src=//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><a id=logo href=https://4ft35t.github.io/>4ft35t blog</a><p class=description>折腾笔记</p></div><div><nav id=nav-menu class=clearfix><a class=current href=https://4ft35t.github.io/>首页</a>
<a href=https://4ft35t.github.io/archives/ title=归档>归档</a>
<a href=https://4ft35t.github.io/about/ title=关于>关于</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>解决无忧行长时间显示“正在连接电话服务器”问题</h1></header><date class="post-meta meta-date">2020年4月9日</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=https://4ft35t.github.io/categories/network>Network</a></span></div><div class=post-content><p>无忧行(JegoTrip)APP是中国移动专门为出境游用户量身打造的APP。在境内也可以使用，移动号码可以在 APP 内接电话和收短信, 轻松实现一机双号。</p><h2 id=具体症状>具体症状</h2><p>家里路由器上部署梯子, 国内 IP 直连，其余 IP 走梯子, 国内 IP 库用的 <a href=https://github.com/17mon/china_ip_list>https://github.com/17mon/china_ip_list</a>。连接家里 WIFI，无忧行 APP 启动后，显示“正在连接电话服务器”, 持续 30 秒以上才能连接到服务器，之后才能收到短信；用 4G 则没有这个提示，启动 APP 瞬间就能收到短信。猜测是无忧行服务器的香港 IP 走梯子后比直连慢很多所致。</p><h2 id=排查-ip>排查 IP</h2><p>从 Pi-hole 导出 jego 相关域名, <code>192.168.1.123</code> 是手机 IP</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash> sqlite3 pihole-FTL.db <span style=color:#e6db74>&#34;select distinct
</span><span style=color:#e6db74> domain from queries where client=&#39;192.168.1.123&#39; and domain like &#39;%jego%&#39;&#34;</span>
</code></pre></div><p>得到几个域名</p><blockquote><p>app1.jegotrip.com.cn<br>tms.jegotrip.com.cn<br>jegotrip-stage.cn-hongkong.log.aliyuncs.com<br>cdn.jegotrip.com.cn<br>oss.jegotrip.com.cn<br>cp.jegotrip.com.cn</p></blockquote><p>逐一排查后，<strong>tms.jegotrip.com.cn</strong> 解析到 223.118.41.228, 是香港 IP。</p><h2 id=更新-ip-列表>更新 IP 列表</h2><p>223.118.41.228 属于 AS58453 自治域，把这个自治域中的几个 IP 段全部追加到国内 IP 列表。</p><pre><code>223.118.0.0/15
223.119.0.0/16
223.120.0.0/16
223.121.0.0/16
</code></pre><p>重启梯子服务后问题解决。</p></div><div class=post-archive><h2>See Also</h2><ul class=listing><li><a href=/post/hugo-auto-deploy-with-github-actions/>使用 Github Actions 自动部署 Hugo</a></li><li><a href=/post/test/>Test</a></li><li><a href=/about/>关于我</a></li><li><a href=/archives/>归档</a></li><li><a href=/search/>搜索</a></li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a href=https://4ft35t.github.io/tags/jegotrip>jegotrip</a></li><li><a href=https://4ft35t.github.io/tags/ip>IP</a></li><li><a href=https://4ft35t.github.io/tags/pi-hole>pi-hole</a></li><li><a href=https://4ft35t.github.io/tags/pihole>pihole</a></li></ul></div></article><div class="post bg-white"><script src=https://utteranc.es/client.js repo=4ft35t/4ft35t.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://4ft35t.github.io/>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>最近文章</h3><ul class=widget-list><li><a href=https://4ft35t.github.io/post/jegotrip-takes-long-time-to-connect/ title=解决无忧行长时间显示“正在连接电话服务器”问题>解决无忧行长时间显示“正在连接电话服务器”问题</a></li><li><a href=https://4ft35t.github.io/post/hugo-auto-deploy-with-github-actions/ title="使用 Github Actions 自动部署 Hugo">使用 Github Actions 自动部署 Hugo</a></li><li><a href=https://4ft35t.github.io/post/test/ title=Test>Test</a></li></ul></section><section class=widget><h3 class=widget-title>分类</h3><ul class=widget-list><li><a href=https://4ft35t.github.io/categories/github/>Github (1)</a></li><li><a href=https://4ft35t.github.io/categories/network/>Network (1)</a></li></ul></section><section class=widget><h3 class=widget-title>标签</h3><div class=tagcloud><a href=https://4ft35t.github.io/tags/github/>github</a>
<a href=https://4ft35t.github.io/tags/hugo/>hugo</a>
<a href=https://4ft35t.github.io/tags/ip/>IP</a>
<a href=https://4ft35t.github.io/tags/jegotrip/>jegotrip</a>
<a href=https://4ft35t.github.io/tags/pi-hole/>pi-hole</a>
<a href=https://4ft35t.github.io/tags/pihole/>pihole</a></div></section><section class=widget><h3 class=widget-title>其它</h3><ul class=widget-list><li><a href=https://4ft35t.github.io/index.xml>文章 RSS</a></li></ul></section></div></div></div></div><footer id=footer><div class=container>&copy; 2020 <a href=https://4ft35t.github.io/>4ft35t blog By af.test</a>.
Powered by <a rel="nofollow noreferer noopener" href=https://gohugo.io target=_blank>Hugo</a>.
<a href=https://www.flysnow.org/ target=_blank>Theme</a> based on <a href=https://github.com/flysnow-org/maupassant-hugo target=_blank>maupassant</a>.</div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:true}};</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src="/js/totop.js?v=0.0.0" async></script></body></html>